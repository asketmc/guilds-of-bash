# Test Structure Reference (core-test) 2026-01-22

## Location & Stack

- **Gradle module:** `core-test`
- **Test sources:** `core-test/src/test/kotlin/test/`
- **Language / framework:** Kotlin + JUnit 5 (via `kotlin.test` + JUnit annotations)

## Test Levels & Conventions

- **P1 (critical):**
  - File naming pattern: `P1_###_*Test.kt`
  - Package: `test`
- **P2 (major):**
  - Conventionally covered via integration-style scenarios in the same module;
- **P3 (normal / perf):**
  - Example perf test file: `P3_001_CorePerfLoadTest.kt`
  - Intended to be excluded from “fast CI” runs

> Exact numeric counts (tests/files) are intentionally not included to reduce update churn. Use Gradle test reports for current totals.

## Shared Test Infrastructure (within `core-test/src/test/kotlin/test/`)

- `TestHelpers.kt`
  - Scenario runner helpers (e.g. `runScenario`, `Scenario`, `ScenarioResult`)
  - Common assertions (e.g. `assertNoRejections`, `assertNoInvariantViolations`, `assertEventTypesPresent`)
- `Smoke.kt`
  - `@Smoke` annotation to mark a minimal / fastest subset of tests

## Running Tests

### All tests in `core-test`

```powershell
.\gradlew.bat :core-test:test
````

```bash
./gradlew :core-test:test
```

### Targeted execution (Gradle test filtering)

```powershell
# Single test class
.\gradlew.bat :core-test:test --tests "test.P1_009_ReducerCriticalTest"

# Single test method (pattern)
.\gradlew.bat :core-test:test --tests "test.P1_009_ReducerCriticalTest.someMethodPattern*"
```

### Common Gradle flags

```powershell
.\gradlew.bat :core-test:test --info
.\gradlew.bat :core-test:test --stacktrace
.\gradlew.bat :core-test:test --rerun-tasks
```

### Build tasks (examples)

```powershell
.\gradlew.bat :core:build
.\gradlew.bat :adapter-console:build
.\gradlew.bat clean build
```

## Test Reports & Artifacts (generated by `:core-test:test`)

* **XML results:** `core-test/build/test-results/test/*.xml`
* **HTML report:** `core-test/build/reports/tests/test/index.html`

### Open HTML report (Windows)

```powershell
Start-Process core-test\build\reports\tests\test\index.html
```

### Inspect XML quickly (Windows)

```powershell
Get-Content core-test\build\test-results\test\*.xml
```

## Document Update Policy

* This file describes stable structure (paths, naming conventions, entrypoints, report locations).
* When conventions, module layout, or CI entrypoints change, update the affected sections manually.

```